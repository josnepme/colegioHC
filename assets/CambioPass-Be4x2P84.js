import{Q as L}from"./QPage-CeyVCo50.js";import{s as U,a as Q,d as A,c as Y,b as S}from"./index-hrFfsE_O.js";import{m as F,c as N,a as V,b as G,s as P}from"./index.esm-1pO_CygL.js";import"./index-C_9uIoC2.js";import{api as T}from"./axios-DN8dVMgI.js";import{u as H}from"./auth-Dzym9PFD.js";import{u as J}from"./index-DmLa8JJ9.js";import{a as u,e as n,k as p,o as m,p as a,h as e,Y as l,j as f,b as r,f as b,t as x}from"./index-BaiCGngT.js";import"./index-DR3ylfnb.js";import"./index-ZhWAdK_X.js";import"./_commonjsHelpers-CqkleIqs.js";const K={class:"border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50 dark:bg-surface-950 flex-auto flex justify-center items-center font-medium"},W={class:"flex pt-6 justify-end"},X={class:"flex flex-col h-48 q-mt-md"},Z={class:"row q-gutter-md"},pe={__name:"CambioPass",setup(ee){const q=H(),w=J(),_=u(""),t=u(!1),v=u(""),g=u(""),E=u({password:""}),j=F(N({password:V().required("El campo es requerido")})),B=({valid:o})=>{o?M():t.value=!1},M=async()=>{var o=new FormData;o.append("password",_.value),o.append("id",q.iduser),o.append("opcion",2),(await T.post("auth",o)).data.mensaje=="Contraseña Incorrecta"?(w.add({severity:"error",summary:"Contraseña Incorrecta",detail:"Vuelva a Introducir la Contraseña",life:3e3,group:"bc",closable:!1}),t.value=!1):(w.add({severity:"success",summary:"Contraseña Correcta",detail:"Proceda a Cambiar la Contraseña",life:4e3,group:"bc",closable:!1}),t.value=!0)},I=u({password2:"",confirmpassword:""}),O=F(N({password2:V().required("El campo es requerido"),confirmpassword:V().required("la contraseña es requerida").oneOf([G("password2"),null],"Las contraseñas deben ser iguales")})),R=({valid:o})=>{o&&$()},$=async()=>{var o=new FormData;o.append("password",v.value),o.append("id",q.iduser),o.append("opcion",3),(await T.post("auth",o)).data.mensaje=="ok"&&(w.add({severity:"success",summary:"Cambio de Contraseña Correcto",detail:"Para que los cambios surtan efecto, por favor vuelva a loguearse...",life:5e3,group:"bc",closable:!1}),g.value="",v.value="",t.value=!1)};return(o,s)=>{const c=n("Message"),k=n("Password"),y=n("FloatLabel"),C=n("Button"),h=n("Toast"),z=n("Card");return m(),p(L,{padding:""},{default:a(()=>[e(z,null,{content:a(()=>[e(l(U),{value:"1",linear:"",class:"basis-[50rem]"},{default:a(()=>[e(l(Q),null,{default:a(()=>[e(l(A),{value:"1"},{default:a(()=>[e(c,null,{default:a(()=>s[3]||(s[3]=[f("Contraseña Antigua")])),_:1,__:[3]})]),_:1}),e(l(A),{value:"2"},{default:a(()=>[e(c,null,{default:a(()=>s[4]||(s[4]=[f("Contraseña Nueva")])),_:1,__:[4]})]),_:1})]),_:1}),e(l(Y),null,{default:a(()=>[e(l(S),{value:"1"},{default:a(({activateCallback:i})=>[r("div",K,[e(l(P),{id:"Formulariopass",resolver:l(j),initialValues:E.value,onSubmit:B,class:"flex flex-col gap-4 w-full sm:w-64"},{default:a(d=>[r("div",null,[e(y,null,{default:a(()=>[e(k,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=D=>_.value=D),toggleMask:"",feedback:!1,name:"password",id:"password",disabled:t.value},null,8,["modelValue","disabled"]),s[5]||(s[5]=r("label",{for:"password",class:"block mb-2"},"CONTRASEÑA",-1))]),_:1,__:[5]}),d.password?.invalid?(m(),p(c,{key:0,severity:"error",size:"small",variant:"simple"},{default:a(()=>[f(x(d.password.error.message),1)]),_:2},1024)):b("",!0)]),e(C,{form:"Formulariopass",label:"Verificar",type:"submit",icon:"pi pi-unlock",disabled:t.value},null,8,["disabled"])]),_:1},8,["resolver","initialValues"])]),r("div",W,[t.value?(m(),p(C,{key:0,label:"Proximo",icon:"pi pi-arrow-right",onClick:d=>(i("2"),t.value=!1)},null,8,["onClick"])):b("",!0)])]),_:1}),e(l(S),{value:"2"},{default:a(()=>[r("div",X,[e(l(P),{initialValues:I.value,resolver:l(O),onSubmit:R},{default:a(i=>[r("div",Z,[r("div",null,[e(y,null,{default:a(()=>[e(k,{name:"password2",id:"password2",modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=d=>g.value=d),fluid:"",style:{height:"36px",width:"200px","background-color":"aliceblue"},feedback:!1,toggleMask:""},null,8,["modelValue"]),s[6]||(s[6]=r("label",{for:"password2",class:"block mb-2",style:{color:"darkgrey","background-color":"aliceblue"}},"CONTRASEÑA",-1))]),_:1,__:[6]}),i.password2?.invalid?(m(),p(c,{key:0,severity:"error",size:"small",variant:"simple"},{default:a(()=>[f(x(i.password2.error.message),1)]),_:2},1024)):b("",!0)]),r("div",null,[e(y,null,{default:a(()=>[e(k,{name:"confirmpassword",id:"confirmpassword",modelValue:v.value,"onUpdate:modelValue":s[2]||(s[2]=d=>v.value=d),fluid:"",style:{height:"36px",width:"200px","background-color":"aliceblue"},feedback:!1,toggleMask:""},null,8,["modelValue"]),s[7]||(s[7]=r("label",{for:"confirmpassword",class:"block mb-2",style:{color:"darkgrey","background-color":"aliceblue"}},"REPITA CONTRASEÑA",-1))]),_:1,__:[7]}),i.confirmpassword?.invalid?(m(),p(c,{key:0,severity:"error",size:"small",variant:"simple"},{default:a(()=>[f(x(i.confirmpassword.error.message),1)]),_:2},1024)):b("",!0)]),e(C,{label:"guardar",type:"submit",onClick:i.confirmpassword?.valid},null,8,["onClick"])])]),_:1},8,["initialValues","resolver"])])]),_:1})]),_:1})]),_:1}),e(h,{position:"bottom-center",group:"bc"})]),_:1})]),_:1})}}};export{pe as default};
